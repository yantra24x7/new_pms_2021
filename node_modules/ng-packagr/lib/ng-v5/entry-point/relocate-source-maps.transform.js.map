{"version":3,"file":"relocate-source-maps.transform.js","sourceRoot":"","sources":["../../../../src/lib/ng-v5/entry-point/relocate-source-maps.transform.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,qDAAwE;AACxE,wDAA+D;AAC/D,sCAAsC;AACtC,oCAAkE;AAClE,oDAA4D;AAE/C,QAAA,2BAA2B,GAAc,gCAAoB,CAAC,CAAM,KAAK,EAAC,EAAE;IACvF,MAAM,UAAU,GAAG,KAAK,CAAC,IAAI,CAAC,8BAAsB,EAAE,CAAmB,CAAC;IAC1E,MAAM,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC;IAErD,qCAAqC;IACrC,GAAG,CAAC,IAAI,CAAC,wBAAwB,CAAC,CAAC;IAEnC,MAAM,QAAQ,GAAG,0BAAiB,CAAC,UAAU,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;IAC3E,MAAM,6BAAkB,CAAC,QAAQ,EAAE,IAAI,CAAC,EAAE;QACxC,IAAI,WAAW,GAAG,IAAI,CAAC;QACvB,qCAAqC;QACrC,OAAO,WAAW,CAAC,UAAU,CAAC,KAAK,CAAC,EAAE,CAAC;YACrC,WAAW,GAAG,WAAW,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QACzC,CAAC;QAED,MAAM,CAAC,QAAQ,QAAQ,IAAI,WAAW,EAAE,CAAC;IAC3C,CAAC,CAAC,CAAC;IAEH,MAAM,CAAC,KAAK,CAAC;AACf,CAAC,CAAA,CAAC,CAAC","sourcesContent":["import { Transform, transformFromPromise } from '../../brocc/transform';\nimport { relocateSourceMaps } from '../../sourcemaps/relocate';\nimport * as log from '../../util/log';\nimport { isEntryPointInProgress, EntryPointNode } from '../nodes';\nimport { getGlobForMapWork } from '../../sourcemaps/shared';\n\nexport const relocateSourceMapsTransform: Transform = transformFromPromise(async graph => {\n  const entryPoint = graph.find(isEntryPointInProgress()) as EntryPointNode;\n  const moduleId = entryPoint.data.entryPoint.moduleId;\n\n  // 4. SOURCEMAPS: RELOCATE ROOT PATHS\n  log.info('Relocating source maps');\n\n  const patterns = getGlobForMapWork(entryPoint.data.destinationFiles, true);\n  await relocateSourceMaps(patterns, path => {\n    let trimmedPath = path;\n    // Trim leading '../' path separators\n    while (trimmedPath.startsWith('../')) {\n      trimmedPath = trimmedPath.substring(3);\n    }\n\n    return `ng://${moduleId}/${trimmedPath}`;\n  });\n\n  return graph;\n});\n"]}